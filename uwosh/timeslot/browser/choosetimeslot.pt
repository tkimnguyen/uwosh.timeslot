<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="uwosh.timeslot">

<body>
    <div metal:fill-slot="main">
	<tal:main-macro metal:define-macro="main"
                        tal:define="contextIsMasterSignupSheet context/isMasterSignupSheet;
                                    isCurrentUserLoggedIn view/isCurrentUserLoggedIn;
                                    contactInfo context/getContactInfo">
      
            <h2 tal:content="context/Title" />

            <div style="border: 1px solid #8CACBB; padding: 10px" tal:condition="context/hasCurrentUserSelectedAnySlot">
	        <p>To cancel, select one or more of your reserved slots and click the "Cancel Selected Slots" button.</p>
		<form method="post" tal:attributes="action string:${context/absolute_url}/cancel-reservation;">
	            <table class="plain">
		        <tal:block tal:condition="context/isCurrentUserSignedUpForAnySlot">
		            <th colspan="2">You are signed up for the following slots:</th>
			    <tr tal:repeat="slot context/getSlotsCurrentUserIsSignedUpFor">
			        <tal:block tal:define="label slot/getLabel">
		                    <td style="border-right: none" tal:content="label" />
				    <td style="border-left: none">
				        <input type="checkbox" name="selectedSlot" tal:attributes="value label" />
				    </td>
				</tal:block>
			     </tr>
			</tal:block>
			<tal:block tal:condition="context/isCurrentUserWaitingForAnySlot">
		            <th colspan="2">You are on a waiting list for the following slots:</th>
			    <tr tal:repeat="slot context/getSlotsCurrentUserIsWaitingFor">
		                <tal:block tal:define="label slot/getLabel">
		                    <td style="border-right: none" tal:content="label" />
				    <td style="border-left: none">
				        <input type="checkbox" name="selectedSlot" tal:attributes="value label" />
				    </td>
				</tal:block>
			     </tr>
			</tal:block>
		    </table>
		    <br />
		    <input type="submit" name="cancelSlots" value="Cancel Selected Slots" />
		</form>
		     
            </div>
      
            <tal:block tal:condition="not:isCurrentUserLoggedIn">
		<p>To signup for a spot you will need to
                   <a tal:attributes="href string:${context/absolute_url}/login_form?came_from=${context/absolute_url}/choose-timeslot">
                   login</a> first.
                </p>
	    </tal:block>

            <div tal:condition="contactInfo" id="contactInfo">
		<h3>If you have any questions please contact:</h3>
		  
		<tal:block tal:repeat="line contactInfo">
		    <span tal:content="line" /><br />
		</tal:block>
		  
		<br />
	    </div>
		
	    <form method="post" tal:attributes="action string:${context/absolute_url}/submit-user-selection;">
		<p tal:condition="contextIsMasterSignupSheet">
		    Please select a time from one of the following signup sheets:
		</p>

	        <tal:block tal:repeat="signupSheet context/getSignupSheets">

		    <tal:block tal:condition="not:signupSheet/isMasterSignupSheet"
	                       tal:define="days signupSheet/getDays">
		
		        <dl tal:omit-tag="not:contextIsMasterSignupSheet" class="collapsible inline collapsedOnLoad">

			    <h1 tal:condition="contextIsMasterSignupSheet" style="border-bottom: none">
		                <dt tal:content="signupSheet/Title" class="collapsibleHeader" />
			    </h1>
				  
		            <dd tal:omit-tag="not:contextIsMasterSignupSheet" class="collapsibleContent">
				<table class="plain">
				    <tal:block tal:condition="not:days">
					<tr style="background-color: #F0F0F0">
					    <th style="border: none">
						<h3>No days have been made available for this signup sheet yet.</h3>
					    </th>
					</tr>
				    </tal:block>

				    <tal:block tal:repeat="day days">
					<tr style="background-color: #F0F0F0">
					    <th style="border: none">
						<h3 tal:content="day/Title" />
					    </th>
					    <th style="border: none" colspan="2"/>
					</tr>

					<tr>
					    <th>Time</th>
					    <th>Available Spots</th>
					    <th>Select</th>
					</tr>
					<tal:block tal:define="timeSlots day/getTimeSlots">
					    <tr tal:condition="not:timeSlots">
					        <td colspan="3">No slots have been made available for this day yet.</td>
					    </tr>
					    <tr tal:repeat="timeSlot timeSlots">
					        <td tal:content="timeSlot/Title" />
						<td>
						    <span tal:content="timeSlot/getNumberOfAvailableSpots" />
						    <span tal:condition="timeSlot/getAllowWaitingList">
						        + Waiting List
						    </span>
					        </td>
					        <td align="center" tal:define="userAlreadySignedup timeSlot/isCurrentUserSignedUpForThisSlot">
						    <em>
						        <strong tal:condition="userAlreadySignedup">
							    &rarr; Your Slot &larr;
						        </strong>
					            </em>

						    <span tal:condition="not:userAlreadySignedup" tal:define="full timeSlot/isFull">
						        <input tal:condition="not:full" type="radio" name="slotSelection"
							       tal:attributes="value timeSlot/getLabel" /> 
						        <p tal:condition="full">Full</p>
						    </span>
					        </td>
				  	    </tr>
					</tal:block>
				    </tal:block>
				</table>
				<br />
			    </dd>
		        </dl>
         	    </tal:block>
			
		</tal:block>
			
		<div tal:condition="view/isAnyExtraInfoRequired" id="extraInfo">
		    <br />
		    <h3>Required Extra Information</h3>

		    <br />
		    <tal:block tal:condition="view/isPhoneRequired">
			<label style="float:left; width:11em" for="phone">Campus Phone: </label>
			<input type="text" id="phone" name="phone" />
			<br />
			<br />
		    </tal:block>

		    <tal:block tal:condition="view/isClassRequired">
			<label style="float:left; width:11em" for="classification">Employee Classification Type: </label>
			<select id="classification" size="1" name="classification">
			    <option value="" selected="selected">Select Classification Type</option>
			    <option value="Academic">Academic Staff</option>
			    <option value="Classified">Classified Staff</option>
			    <option value="Faculty">Faculty</option>
			    <option value="LTE">Limited Term Employee</option>
			    <option value="Other">Other</option>
			    <option value="Spouse - Faculty">Spouse - Faculty</option>
			    <option value="Student">Student</option>
			</select>
			<br />
			<br />
		    </tal:block>

		    <tal:block tal:condition="view/isDepartmentRequired">
			<label style="float:left; width:11em" for="dept">Department: </label>
			<input type="text" id="dept" name="dept" />
			<br />
			<br />
		    </tal:block>
		</div>

		<tal:block tal:condition="isCurrentUserLoggedIn">
		    <input type="submit" name="form.button.submit" value="Submit" />
    		    <input type="hidden" name="form.submitted" value="1" />
		    <input tal:attributes="value member" type="hidden" name="memberToAssign" />
		</tal:block>
	    </form>

        </tal:main-macro>
    </div>
</body>
</html>
